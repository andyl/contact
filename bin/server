#!/usr/bin/env elixir 

Mix.install([ 
  # :formin, path: __ENV__.file |> Path.dirname() |> Path.dirname()
  # :formin, path: "/home/aleak/src/formin"
  :formin, github: "andyl/formin"
])

cli_opts = Formin.Pom.Cli.main(System.argv())

Application.put_env(:formin, :port, cli_opts.options.port)
Application.put_env(:formin, :server, true)

Mix.Task.run("app.start", ["--preload-modules"])

cli_opts
|> Formin.Svc.Opts.set_state()
|> IO.inspect(label: "CRAZED")

Mix.Tasks.Run.run(["--no-halt"])

